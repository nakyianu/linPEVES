#! /bin/bash
# Environmental variable exploit

# Receives exploitable env variables from scan
exploitable_passwords=0
EXPLOIT=1
VERBOSE=0

if [[ EXPLOIT == 1 ]] && [[ -z exploitable_passwords ]]; then
    # User has requested the exploit of this vulnerability but it was not present on this machine
    echo "There were no exploitable passwords found in the env variables."

elif [[ EXPLOIT == 1 ]]; then
    # Prints each password on a new line
    echo "Here are the hidden passwords!"
    while IFS= read -r line; do
        echo "Found password: $line"
    done <<< "$exploitable_passwords"
fi
